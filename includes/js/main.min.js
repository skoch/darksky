var Main=new function(){var _self=this;var _debug=false;var _apiKey="a04ca3cc3da6efe8dd6c74f37f16b81e";var _coords={};var _weather={};this.publicvariable="foo";this.init=function init($debug){_debug=$debug;_getLocation();$(".nav li").click(_clickNav)};function _updateView($hash){$("li").each(function($i){$(this).removeClass("active")});switch($hash){case "#nutshell":$($("ul").children("li")[0]).addClass("active");break;case "#hourly":$($("ul").children("li")[1]).addClass("active");break;case "#day":$($("ul").children("li")[2]).addClass("active");
break}$("#hourly").addClass("hide");$("#day").addClass("hide");$("#nutshell").addClass("hide");$($hash).removeClass("hide")}function _clickNav($evt){var hash=$($evt.target).children("a").context.hash;$("#hourly").addClass("hide");$("#day").addClass("hide");$("#nutshell").addClass("hide");$(hash).removeClass("hide");$("li").each(function($i){$(this).removeClass("active")});$($evt.currentTarget).addClass("active")}function _getLocation(){if(navigator.geolocation)navigator.geolocation.getCurrentPosition(_getDarkSky);
else alert("geolocationless browser")}function _getDarkSky($position){_coords.lat=$position.coords.latitude;_coords.lon=$position.coords.longitude;var url="https://api.darkskyapp.com/v1/forecast/"+_apiKey+"/"+_coords.lat+","+_coords.lon;if(_debug=="debug"){url="includes/json/hourData-1.json";$.getJSON(url,function($data){_processData($data)})}else $.get(url,function($data){_processData($data)},"jsonp")}function _processData($data){_weather=$data;$("#isPrecipitating dd").html(_weather.isPrecipitating?
"YES":"NO");$("#currentTemp dd").html(_weather.currentTemp+"&#176;F");$("#currentSummary dd").html(_weather.currentSummary);$("#daySummary dd").html(_weather.daySummary);$("#hourSummary dd").html(_weather.hourSummary);$("#currentIntensity dd").html(_weather.currentIntensity);var update=moment().add("minutes",_weather.checkTimeout/60).calendar();$("#updateIn dd").html(update);var valuesx=[];var valuesy_probability=[];var valuesy_intensity_top=[];var valuesy_intensity=[];var valuesy_intensity_bottom=
[];var low=[];var med=[];var high=[];for(var i=0;i<_weather.hourPrecipitation.length;i++){valuesx[i]=i;var probability=Math.round(_weather.hourPrecipitation[i].probability*100);valuesy_probability[i]=probability;valuesy_intensity_top[i]=_weather.hourPrecipitation[i].intensity+_weather.hourPrecipitation[i].error;valuesy_intensity[i]=_weather.hourPrecipitation[i].intensity;valuesy_intensity_bottom[i]=_weather.hourPrecipitation[i].intensity-_weather.hourPrecipitation[i].error;var item='<dl class=""><dt>'+
_parseTimestamp(_weather.hourPrecipitation[i].time)+"</dt><dd>"+probability+"% chance of "+_weather.hourPrecipitation[i].type+"<br>("+_weather.hourPrecipitation[i].intensity+" &plusmn;"+_weather.hourPrecipitation[i].error+")</dd></dl>";$("#hourly").append(item);low[i]=15;med[i]=30;high[i]=45}var r=Raphael("chart-div");r.linechart(0,0,320,200,[valuesx,valuesx,valuesx,[0,59]],[valuesy_intensity,valuesy_intensity_top,valuesy_intensity_bottom,[0,75]],{shade:true,axis:"0 0 1 0",smooth:true,axisxstep:4,
colors:["#2f69bf","#a2bf2f","#bf5a2f","transparent"]});r.linechart(0,0,320,200,[valuesx,[0,59]],[low,med,high,[0,75]],{colors:["#2f69bf","#a2bf2f","#bf5a2f","transparent"],dash:"-"});for(var i=0;i<_weather.dayPrecipitation.length;i++){var probability=Math.round(_weather.dayPrecipitation[i].probability*100);var item='<dl class=""><dt>'+_weather.dayPrecipitation[i].temp+"&#176;F @ "+_parseTimestamp(_weather.dayPrecipitation[i].time)+"</dt><dd>"+probability+"% chance of "+_weather.dayPrecipitation[i].type+
"<br>Cloud Cover: "+_weather.dayPrecipitation[i].cloudCover+"<br>Relative Humidity: "+_weather.dayPrecipitation[i].relHumidity+"</dd></dl>";$("#day").append(item);_weather.dayPrecipitation[i]}}function _parseTimestamp($timestamp){var date=new Date($timestamp*1E3),dateValues=[date.getFullYear(),date.getMonth()<10?"0"+(date.getMonth()+1):date.getMonth()+1,date.getDate()<10?"0"+date.getDate():date.getDate(),date.getHours()<10?"0"+date.getHours():date.getHours(),date.getMinutes()<10?"0"+date.getMinutes():
date.getMinutes(),date.getSeconds()<10?"0"+date.getSeconds():date.getSeconds()];var dateString=dateValues[3]+":"+dateValues[4];return dateString}$(function(){if(window.location.hash!=="")_updateView(window.location.hash)})};